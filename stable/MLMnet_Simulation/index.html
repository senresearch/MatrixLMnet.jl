<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started ¬∑ MatrixLMnet</title><meta name="title" content="Getting Started ¬∑ MatrixLMnet"/><meta property="og:title" content="Getting Started ¬∑ MatrixLMnet"/><meta property="twitter:title" content="Getting Started ¬∑ MatrixLMnet"/><meta name="description" content="Documentation for MatrixLMnet."/><meta property="og:description" content="Documentation for MatrixLMnet."/><meta property="twitter:description" content="Documentation for MatrixLMnet."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MatrixLMnet</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Data-Generation"><span>Data Generation</span></a></li><li><a class="tocitem" href="#Model-Estimation"><span>Model Estimation</span></a></li><li><a class="tocitem" href="#Model-predictions-and-residuals"><span>Model predictions and residuals</span></a></li></ul></li><li><a class="tocitem" href="../functions/">Types and Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/senresearch/MatrixLMnet.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/senresearch/MatrixLMnet.jl/blob/main/docs/src/MLMnet_Simulation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p><code>MatrixLMnet.jl</code> is a comprehensive package for both <span>$L_1$</span> and <span>$L_2$</span> penalized estimation in matrix linear models.    It offers efficient and versatile methods for fitting sparse matrix linear models, particularly for analyzing structured high-throughput data. In this demonstration, we will explore the functionalities of this package through an easy-to-follow simulation study, showcasing its practical applications and user-friendly features.    </p><p>Within the scope of the matrix linear model framework, the model is articulated as follows:   </p><p class="math-container">\[Y = XBZ^T+E\]</p><p>Where     </p><ul><li><span>$Y_{n \times m}$</span> is the response matrix,   </li><li><span>$X_{n \times p}$</span> is the matrix for main predictors,   </li><li><span>$Z_{m \times q}$</span> denote the response attributes matrix based on a supervised knowledge,   </li><li><span>$E_{n \times m}$</span> is the error term,   </li><li><span>$B_{p \times q}$</span> is the matrix for main and interaction effects.,</li></ul><h2 id="Data-Generation"><a class="docs-heading-anchor" href="#Data-Generation">Data Generation</a><a id="Data-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Generation" title="Permalink"></a></h2><pre><code class="language-julia hljs">using MatrixLMnet
using DataFrames
using Plots</code></pre><p>In this example,  we set up a simulation for matrix linear models.  We generate a dataset containing two categorical variables and four numerical variables.</p><pre><code class="language-julia hljs"># Define number of samples in the predictors dataset
n = 100

# Generate data with one categorical variables and 3 numerical variables.
dfX = hcat(DataFrame(
    catvar1=rand([&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;], n)), 
    DataFrame(rand(n,3), [&quot;numvar1&quot;, &quot;numvar2&quot;, &quot;numvar3&quot;]));

first(dfX, 3)</code></pre><div><div style = "float: left;"><span>3√ó4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">catvar1</th><th style = "text-align: left;">numvar1</th><th style = "text-align: left;">numvar2</th><th style = "text-align: left;">numvar3</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">A</td><td style = "text-align: right;">0.0272858</td><td style = "text-align: right;">0.880826</td><td style = "text-align: right;">0.284163</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">B</td><td style = "text-align: right;">0.571666</td><td style = "text-align: right;">0.414586</td><td style = "text-align: right;">0.406994</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">A</td><td style = "text-align: right;">0.151188</td><td style = "text-align: right;">0.680321</td><td style = "text-align: right;">0.424177</td></tr></tbody></table></div><p>We need to create a design matrix <strong>X</strong> form the dataframe <em>dfX</em>. We can use the <code>design_matrix()</code> function from the package <code>MatrixLM.jl</code>. For more information about its usage and the macro <code>@mlmformula</code> please refer to its <a href="https://senresearch.github.io/MatrixLM.jl/stable/">documentation</a>.       First, we need to select the contrast coding of our categorical variable.</p><pre><code class="language-julia hljs"># Define constrast coding for catvar 
levels_catvar1 = sort(unique(dfX.catvar1));
X_ctrst = Dict(
             :catvar1 =&gt; MatrixLMnet.MatrixLM.StatsModels.DummyCoding(levels = levels_catvar1),
           );</code></pre><p>Let convert the dataframe <em>dfX</em> to the predictor matrix <strong>X</strong> using <code>design_matrix()</code>:</p><pre><code class="language-julia hljs">X = design_matrix(@mlmformula(1 + catvar1 + numvar1 + numvar2 + numvar3), dfX, X_ctrst);</code></pre><p>We also define <strong>Z</strong>, a random matrix with dimensions <em>m</em> by <em>q</em>, and <strong>B</strong>, a matrix of random integers between -5 and 5 with dimensions matching <strong>X</strong> and <strong>Z</strong>. According the matrix linear models framework, the response matrix <strong>Y</strong> is calculated as the product of <strong>X</strong>, <strong>B</strong>, and the transpose of <strong>Z</strong>, with an added noise matrix <strong>E</strong>.     Finally, we construct a <code>RawData</code> object named <code>dat</code>`, which comprises the response matrix <strong>Y</strong> and the predictor matrices <strong>X</strong> and <strong>Z</strong>.</p><pre><code class="language-julia hljs"># Number of predictors
p = size(X)[2]
# Number of column responses
m = 250
# Number of column covariates
q = 20

Z = rand(m,q)
B = rand(-5:5,p,q)
E = randn(n,m)
Y = X*B*transpose(Z)+E

# Construct a RawData object
dat = RawData(Response(Y), Predictors(X, Z));</code></pre><h2 id="Model-Estimation"><a class="docs-heading-anchor" href="#Model-Estimation">Model Estimation</a><a id="Model-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Estimation" title="Permalink"></a></h2><h3 id="Hyper-parameters"><a class="docs-heading-anchor" href="#Hyper-parameters">Hyper parameters</a><a id="Hyper-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Hyper-parameters" title="Permalink"></a></h3><p>Create a 1d array of lambda penalties values to fit the estimates. If the lambdas are not in descending order, they will be automatically sorted by <code>mlmnet</code>.</p><pre><code class="language-julia hljs">lambdas = reverse(1.5.^(1:3:10))</code></pre><pre><code class="nohighlight hljs">4-element Vector{Float64}:
 57.6650390625
 17.0859375
  5.0625
  1.5</code></pre><p>Create a 1d array of alpha parameter penalties values that determine the penalties mix between <span>$L_1$</span> and <span>$L_2$</span> to fit the estimates according to the Elastic Net penalization method.  In the case of Lasso regression (<span>$L_1$</span> regularization), alpha should be 1, and 0 for Ridge regression (<span>$L_2$</span> regularization). If the alphas are not in descending order, they will be automatically sorted by <code>mlmnet</code>.</p><pre><code class="language-julia hljs">alphas = reverse(collect(0:0.5:1));</code></pre><p>If <code>alphas</code> argument is omitted, a Lasso regression will be applied which is equivalent to <code>alphas = [1]</code>.  </p><h3 id="Elastic-Net-penalization-algorithms-selection"><a class="docs-heading-anchor" href="#Elastic-Net-penalization-algorithms-selection">Elastic Net penalization algorithms selection</a><a id="Elastic-Net-penalization-algorithms-selection-1"></a><a class="docs-heading-anchor-permalink" href="#Elastic-Net-penalization-algorithms-selection" title="Permalink"></a></h3><p>The algorithms available for fitting Elastic Net penalized estimates in <code>mlmnet</code> function come with customizable keyword arguments for fine-tuning.  The <code>method</code> keyword argument selects the function implementing the Elastic-net penalty estimation method. The default method is <strong>ista</strong>; alternative options include <strong>fista</strong>, <strong>fista_bt</strong>, <strong>admm</strong>, and <strong>cd</strong>.     <em>Note: Any irrelevant arguments will simply be disregarded.</em></p><table><tr><th style="text-align: left">Algorithm</th><th style="text-align: right">Methods</th><th style="text-align: right">Parameter</th><th style="text-align: right">Default</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><strong>Coordinate Descent</strong></td><td style="text-align: right">&quot;cd&quot;</td><td style="text-align: right"><code>isRandom</code></td><td style="text-align: right">true</td><td style="text-align: left">Determines the use of either random or cyclic updates</td></tr><tr><td style="text-align: left"><strong>Active Coordinate Descent</strong></td><td style="text-align: right">&quot;cd_active&quot;</td><td style="text-align: right"><code>isRandom</code></td><td style="text-align: right">true</td><td style="text-align: left">Specifies the choice between random and cyclic updates</td></tr><tr><td style="text-align: left"><strong>ISTA</strong> with fixed step size</td><td style="text-align: right">&quot;ista&quot;</td><td style="text-align: right"><code>stepsize</code></td><td style="text-align: right">0.01</td><td style="text-align: left">Sets a fixed step size for updates</td></tr><tr><td style="text-align: left"></td><td style="text-align: right"></td><td style="text-align: right"><code>setStepsize</code></td><td style="text-align: right">true</td><td style="text-align: left">Decides if the fixed step size is to be computed, overriding <code>stepsize</code></td></tr><tr><td style="text-align: left"><strong>FISTA</strong> with fixed step size</td><td style="text-align: right">&quot;fista&quot;</td><td style="text-align: right"><code>stepsize</code></td><td style="text-align: right">0.01</td><td style="text-align: left">Establishes a fixed step size for updates</td></tr><tr><td style="text-align: left"></td><td style="text-align: right"></td><td style="text-align: right"><code>setStepsize</code></td><td style="text-align: right">true</td><td style="text-align: left">Determines if the fixed step size should be recalculated, overriding <code>stepsize</code></td></tr><tr><td style="text-align: left"><strong>FISTA</strong> with backtracking</td><td style="text-align: right">&quot;fista_bt&quot;</td><td style="text-align: right"><code>stepsize</code></td><td style="text-align: right">0.01</td><td style="text-align: left">Indicates the initial step size for updates</td></tr><tr><td style="text-align: left"></td><td style="text-align: right"></td><td style="text-align: right"><code>gamma</code></td><td style="text-align: right">0.5</td><td style="text-align: left">The multiplier for step size during backtracking/line search</td></tr><tr><td style="text-align: left"><strong>ADMM</strong></td><td style="text-align: right">&quot;admm&quot;</td><td style="text-align: right"><code>rho</code></td><td style="text-align: right">1.0</td><td style="text-align: left">The parameter influencing ADMM tuning</td></tr><tr><td style="text-align: left"></td><td style="text-align: right"></td><td style="text-align: right"><code>setRho</code></td><td style="text-align: right">true</td><td style="text-align: left">Decides whether the ADMM tuning parameter <code>rho</code> is to be auto-calculated</td></tr><tr><td style="text-align: left"></td><td style="text-align: right"></td><td style="text-align: right"><code>tau_incr</code></td><td style="text-align: right">2.0</td><td style="text-align: left">The factor for increasing the ADMM tuning parameter</td></tr><tr><td style="text-align: left"></td><td style="text-align: right"></td><td style="text-align: right"><code>tau_decr</code></td><td style="text-align: right">2.0</td><td style="text-align: left">The factor for decreasing the ADMM tuning parameter</td></tr><tr><td style="text-align: left"></td><td style="text-align: right"></td><td style="text-align: right"><code>mu</code></td><td style="text-align: right">10.0</td><td style="text-align: left">The parameter influencing the balance between primal and dual residuals</td></tr></table><h3 id="Estimation"><a class="docs-heading-anchor" href="#Estimation">Estimation</a><a id="Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Estimation" title="Permalink"></a></h3><p>In this example, we will use the &#39;fista&#39; method for our estimation process.  Given that our design matrix already incorporates an intercept, we specify that there is no need to add an additional intercept to the design matrices <strong>X</strong> and <strong>Z</strong>.</p><pre><code class="language-julia hljs">est_fista = mlmnet(
    dat, 
    [lambdas[1]], [alphas[1]], 
    method = &quot;fista&quot;, 
    addZIntercept = false, addXIntercept = false, isVerbose = false);</code></pre><p>Let&#39;s delve into the structure returned by the <code>mlmnet()</code> function. The result, <code>est_fista</code>, is of the <code>Mlmnet</code> type, a structured data type encompassing the next key fields:</p><ul><li><code>B</code>: This is the estimated coefficient matrix. It is a four-dimensional matrix where the dimensions represent rows, columns, lambda indices, and alpha indices.</li><li><code>lambdas</code>: A vector containing the lambda values utilized in the estimation.</li><li><code>alphas</code>: A vector of the alpha values used.</li><li><code>data</code>: A <code>RawData</code> object that holds the original dataset used for the estimation.</li></ul><p>For instance, let execute the command with all lambdas and alphas values:</p><pre><code class="language-julia hljs">est_fista = mlmnet(
    dat, 
    lambdas, alphas, 
    method = &quot;fista&quot;, 
    addZIntercept = false, addXIntercept = false, isVerbose = false);</code></pre><p>In this case, the matrix <code>B</code> would have dimensions of (7, 20, 4, 3). These dimensions correspond to the estimated coefficients across each of the 4 lambda values and 3 alpha values, offering a comprehensive view of the coefficient variations influenced by different regularization parameters.</p><h3 id="Cross-Validation"><a class="docs-heading-anchor" href="#Cross-Validation">Cross Validation</a><a id="Cross-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Cross-Validation" title="Permalink"></a></h3><p>Cross-validation within the <code>mlmnet</code> framework is implemented by the <code>mlmnet_cv</code> function. This function offers flexibility in defining the folds for cross-validation. We can either specify the row and column folds of <code>Y</code> manually as 1D arrays containing row or column indices, or we can simply specify the desired number of folds. When a specific number of folds is indicated, <code>mlmnet_cv</code> will generate disjoint folds of approximately equal size using the <code>make_folds</code> function. Setting the number of row or column folds to <code>1</code> implies the use of all rows or columns of <code>Y</code> in each fold.</p><p>One key benefit of manually inputting row and/or column folds is the user&#39;s ability to stratify or control the nature of the folds. For instance, <code>make_folds_conds</code> can be employed to create folds based on a set of categorical conditions, ensuring each condition is equally represented across folds. Additionally, cross-validation computations are executed in parallel whenever feasible, enhancing efficiency. To incorporate non-standard behaviors in <code>mlmnet</code>, we can pass the relevant keyword arguments directly into <code>mlmnet_cv</code>.</p><p>In the following call, <code>mlmnet_cv</code> is configured to create 10 disjoint row folds while utilizing all columns of <code>Y</code> in each fold, as denoted by the 1:</p><pre><code class="language-julia hljs">est_fista_cv = mlmnet_cv(
    dat, 
    lambdas, alphas,
    10, 1, 
    method = &quot;fista&quot;,  
    addZIntercept = false, addXIntercept = false, isVerbose = false);</code></pre><p><em>Note: The <code>dig</code> keyword argument in <code>mlmnet_cv</code> is used to set the precision level for computing the percentage of zero coefficients. Its default value is <code>12</code>, allowing for detailed precision in the calculations.</em></p><p>The function returns an <code>Mlmnet_cv</code> object, which contains an array of the Mlmnet objects for each fold (<code>MLMNets</code>); the lambda penalty values used (<code>lambdas</code>); the row and column folds (<code>rowFolds</code> and <code>colFolds</code>); an array of the mean-squared error for each fold (<code>mse</code>); and an array of the proportion of zero interaction effects for each fold (<code>propZero</code>). The keyword argument <code>dig</code> in <code>mlmnet_cv</code> adjusts the level of precision when calculating the percent of zero coefficients. It defaults to <code>12</code>.</p><p>The output from the <code>mlmnet_cv()</code> function yields an <code>Mlmnet_cv</code> object. This object encompasses the following components:</p><ul><li><code>MLMNets</code>: An array consisting of the <code>Mlmnet</code> objects corresponding to each fold.</li><li><code>lambdas</code>: The array of lambda penalty values applied during the estimati</li><li><code>alphas</code>: The array of alpha penalty values applied during the estimation.on.</li><li><code>rowFolds</code> and <code>colFolds</code>: Arrays representing the row and column folds used in cross-validation.</li><li><code>mse</code>: An array detailing the mean-squared error for each individual fold.</li><li><code>propZero</code>: An array capturing the proportion of zero interaction effects in each ft <code>12</code>.&quot;</li></ul><p><code>mlmnet_cv_summary</code> presents a table summarizing the average mean-squared error (MSE) and the proportion of zero coefficients for each pair of (lambda, alpha) values across all folds. The optimal (lambda, alpha) could be selected as the one that minimizes the MSE. Alternatively, it might be chosen according to a specific, pre-defined proportion of zeros desired in the coefficient estimates.</p><pre><code class="language-julia hljs">mlmnet_cv_summary(est_fista_cv)</code></pre><div><div style = "float: left;"><span>12√ó6 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">ùúÜ_ùõº_Index</th><th style = "text-align: left;">Lambda</th><th style = "text-align: left;">Alpha</th><th style = "text-align: left;">AvgMSE</th><th style = "text-align: left;">StdMSE</th><th style = "text-align: left;">AvgPropZero</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Tuple{Int64, Int64}" style = "text-align: left;">Tuple‚Ä¶</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">(1, 1)</td><td style = "text-align: right;">57.665</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">18.7416</td><td style = "text-align: right;">1.87917</td><td style = "text-align: right;">0.679286</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">(2, 1)</td><td style = "text-align: right;">17.0859</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">6.46943</td><td style = "text-align: right;">0.57586</td><td style = "text-align: right;">0.42</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">(3, 1)</td><td style = "text-align: right;">5.0625</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">2.49412</td><td style = "text-align: right;">0.290205</td><td style = "text-align: right;">0.178571</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">(4, 1)</td><td style = "text-align: right;">1.5</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">1.22069</td><td style = "text-align: right;">0.071585</td><td style = "text-align: right;">0.0671429</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">(1, 2)</td><td style = "text-align: right;">57.665</td><td style = "text-align: right;">0.5</td><td style = "text-align: right;">32006.4</td><td style = "text-align: right;">3798.02</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">(2, 2)</td><td style = "text-align: right;">17.0859</td><td style = "text-align: right;">0.5</td><td style = "text-align: right;">6609.07</td><td style = "text-align: right;">862.572</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">(3, 2)</td><td style = "text-align: right;">5.0625</td><td style = "text-align: right;">0.5</td><td style = "text-align: right;">829.012</td><td style = "text-align: right;">123.063</td><td style = "text-align: right;">0.005</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">(4, 2)</td><td style = "text-align: right;">1.5</td><td style = "text-align: right;">0.5</td><td style = "text-align: right;">92.8234</td><td style = "text-align: right;">14.5585</td><td style = "text-align: right;">0.005</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">(1, 3)</td><td style = "text-align: right;">57.665</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">61511.1</td><td style = "text-align: right;">7044.65</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">(2, 3)</td><td style = "text-align: right;">17.0859</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">18196.8</td><td style = "text-align: right;">2234.07</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">(3, 3)</td><td style = "text-align: right;">5.0625</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">2839.32</td><td style = "text-align: right;">390.58</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">(4, 3)</td><td style = "text-align: right;">1.5</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">320.418</td><td style = "text-align: right;">49.9818</td><td style = "text-align: right;">0.0</td></tr></tbody></table></div><p>The <code>lambda_min</code> function returns the summary information for the lambdas that correspond to the minimum average test MSE across folds and the MSE that is one standard error greater.</p><pre><code class="language-julia hljs">lambda_min(est_fista_cv)</code></pre><div><div style = "float: left;"><span>2√ó6 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Index</th><th style = "text-align: left;">Lambda</th><th style = "text-align: left;">Alpha</th><th style = "text-align: left;">AvgMSE</th><th style = "text-align: left;">AvgPropZero</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Tuple{Int64, Int64}" style = "text-align: left;">Tuple‚Ä¶</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">(ùúÜ, ùõº)_min</td><td style = "text-align: left;">(4, 1)</td><td style = "text-align: right;">1.5</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">1.22069</td><td style = "text-align: right;">0.0671429</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">(ùúÜ, ùõº)_min1se</td><td style = "text-align: left;">(4, 1)</td><td style = "text-align: right;">1.5</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">1.22069</td><td style = "text-align: right;">0.0671429</td></tr></tbody></table></div><h2 id="Model-predictions-and-residuals"><a class="docs-heading-anchor" href="#Model-predictions-and-residuals">Model predictions and residuals</a><a id="Model-predictions-and-residuals-1"></a><a class="docs-heading-anchor-permalink" href="#Model-predictions-and-residuals" title="Permalink"></a></h2><p>The 4D array of coefficient estimates is returned by the function <code>coef(est)</code>, where <code>est</code> is the results of the function <code>mlmnet</code>. </p><p>The command <code>est_fista.B</code> or <code>coef(est_fista)</code> retrieves the full array containing the estimated coefficients.     Let display the residual errors heatmap based on our estimation.</p><p>To compare the estimated coefficients with the original matrix <strong>B</strong>, we will visualize the matrices using heatmaps. This graphical representation allows us to readily see differences and similarities between the two.</p><pre><code class="language-julia hljs">plot(
    heatmap(B[end:-1:1, :], 
            size = (800, 300)),     
    heatmap(est_fista.B[end:-1:1, :, 4, 1], 
            size = (800, 300)), 
            # clims = (-5, 5)),     
    title = [&quot;\$ \\mathbf{B}\$&quot; &quot;\$ \\mathbf{\\hat{B}}\$&quot;]
)</code></pre><p><img src="../images/output_B_est.svg" alt="svg"/></p><p>To obtain predicted values and residuals, one can use <code>predict</code> and <code>resid</code> respectively.  By default, these functions use the data from the model fit, but alternative data can be supplied: <code>newPredictors</code> (a <code>Predictors</code> object) for <code>predict</code>, and <code>newData</code> (a <code>RawData</code> object) for <code>resid</code>. For added convenience, <code>fitted(est)</code> returns the fitted values by default when calling <code>predict</code>.</p><p>Let&#39;s employ the same visualization method to compare the predicted values with the original <strong>Y</strong> response matrix. This allows us to gauge the accuracy of our model predictions.</p><pre><code class="language-julia hljs">preds = predict(est_fista, lambdas[4], alphas[1]); # Prediction value</code></pre><pre><code class="language-julia hljs">plot(
    heatmap(Y[end:-1:1, :], 
            size = (800, 300)),     
    heatmap(preds[end:-1:1, :], 
            size = (800, 300), 
            clims = (-25, 45)
            ),     
    title = [&quot;\$ \\mathbf{Y}\$&quot; &quot;\$ \\mathbf{\\hat{Y}}\$&quot;],
)</code></pre><p><img src="../images/output_Y_pred.svg" alt="svg"/></p><p>The <code>resid()</code> function provides us with the ability to compute residuals for each observation, helping you evaluate the discrepancy between the model&#39;s predictions and the actual data.</p><pre><code class="language-julia hljs">resids= resid(est_fista, lambdas[4], alphas[1]); </code></pre><pre><code class="language-julia hljs">plot(
    heatmap(
        resids[end:-1:1, :], 
        color = cgrad(:bluesreds,[0.1, 0.3, 0.7, 0.9], alpha = 0.8),
        title = &quot;Residual errors&quot;,
        titlefontsize = 12, grid = false,
        xlabel = &quot;Responses&quot;,
        ylabel = &quot;Samples&quot;,
        size = (500, 250),
        left_margin = (5,:mm), bottom_margin = (5,:mm),
    ),
    histogram(
        (reshape(resids,250*100,1)),
        grid  = false,
        label = &quot;&quot;,
        size = (800, 300)
    ),     
    title = [&quot;Residuals&quot; &quot;Distribution of the residuals&quot;]
)</code></pre><p><img src="../images/output_resid_hist.svg" alt="svg"/></p><p>Additional details can be found in the documentation for specific functions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">¬´ Home</a><a class="docs-footer-nextpage" href="../functions/">Types and Functions ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 12 November 2025 20:28">Wednesday 12 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
